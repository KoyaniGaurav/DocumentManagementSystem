@using Microsoft.AspNetCore.Http
@model DocumentManagementSystem.Models.ProfileUpdateViewModel

@{
    ViewData["Title"] = "Update Profile";
    var role = Context.Session.GetString("UserRole");
    var isAdmin = string.Equals(role, "Admin", System.StringComparison.OrdinalIgnoreCase);
}

<div style="display: flex; justify-content: space-between; align-items: center; margin-bottom: 20px;">
    <h2>Update Profile</h2>
    <form asp-controller="User" asp-action="LogOut" method="post" style="margin: 0;">
        <button type="submit" class="btn btn-danger" style="background-color: #dc3545; padding: 8px 16px; border: none; border-radius: 4px; cursor: pointer;">
            Logout
        </button>
    </form>
</div>

@if (TempData["SuccessMessage"] != null)
{
    <div style="color: green; margin-bottom: 15px; padding: 10px; background-color: #d4edda; border: 1px solid #c3e6cb; border-radius: 4px;">
        @TempData["SuccessMessage"]
    </div>
}

<form asp-action="UpdateProfile" method="post">
    <div asp-validation-summary="ModelOnly" style="color: red; margin-bottom: 15px;"></div>

    <div style="margin-bottom: 15px;">
        <label asp-for="FullName" style="display: block; margin-bottom: 5px; font-weight: bold;"></label>
        <input asp-for="FullName" style="width: 100%; max-width: 400px; padding: 8px; border: 1px solid #ccc; border-radius: 4px;" />
        <span asp-validation-for="FullName" style="color: red;"></span>
    </div>

    <div style="margin-bottom: 15px;">
        <label asp-for="Email" style="display: block; margin-bottom: 5px; font-weight: bold;"></label>
        <input asp-for="Email" style="width: 100%; max-width: 400px; padding: 8px; border: 1px solid #ccc; border-radius: 4px;" />
        <span asp-validation-for="Email" style="color: red;"></span>
    </div>

    <div style="margin-bottom: 15px;">
        <label asp-for="Role" style="display: block; margin-bottom: 5px; font-weight: bold;"></label>
        <input asp-for="Role" readonly style="width: 100%; max-width: 400px; padding: 8px; border: 1px solid #ccc; border-radius: 4px; background-color: #f8f9fa;" />
        <span asp-validation-for="Role" style="color: red;"></span>
    </div>

    <hr style="margin: 20px 0; border: none; border-top: 1px solid #ccc;" />
    <h3>Change Password (Optional)</h3>
    <p style="color: #666; margin-bottom: 15px;">Leave password fields empty if you don't want to change your password.</p>

    <div style="margin-bottom: 15px;">
        <label asp-for="CurrentPassword" style="display: block; margin-bottom: 5px; font-weight: bold;"></label>
        <input asp-for="CurrentPassword" type="password" style="width: 100%; max-width: 400px; padding: 8px; border: 1px solid #ccc; border-radius: 4px;" />
        <span asp-validation-for="CurrentPassword" style="color: red;"></span>
    </div>

    <div style="margin-bottom: 15px;">
        <label asp-for="NewPassword" style="display: block; margin-bottom: 5px; font-weight: bold;"></label>
        <input asp-for="NewPassword" type="password" style="width: 100%; max-width: 400px; padding: 8px; border: 1px solid #ccc; border-radius: 4px;" />
        <span asp-validation-for="NewPassword" style="color: red;"></span>
    </div>

    <div style="margin-bottom: 20px;">
        <label asp-for="ConfirmPassword" style="display: block; margin-bottom: 5px; font-weight: bold;"></label>
        <input asp-for="ConfirmPassword" type="password" style="width: 100%; max-width: 400px; padding: 8px; border: 1px solid #ccc; border-radius: 4px;" />
        <span asp-validation-for="ConfirmPassword" style="color: red;"></span>
    </div>

    <div style="margin-top: 20px;">
        <button type="submit" class="btn" style="background-color: #28a745; color: white; padding: 10px 20px; border: none; border-radius: 4px; cursor: pointer; margin-right: 10px;">Update Profile</button>

        @if (isAdmin)
        {
            <a asp-controller="Admin" asp-action="Index" class="btn" style="background-color: #6c757d; color: white; padding: 10px 20px; text-decoration: none; border-radius: 4px; display: inline-block;">Cancel</a>
        }
        else
        {
            <a asp-controller="User" asp-action="UserIndex" class="btn" style="background-color: #6c757d; color: white; padding: 10px 20px; text-decoration: none; border-radius: 4px; display: inline-block;">Cancel</a>
        }
    </div>
</form>

<style>
    .btn {
        display: inline-block;
        padding: 6px 12px;
        background-color: #4285f4;
        color: white;
        text-decoration: none;
        border-radius: 3px;
        font-size: 14px;
        margin-right: 5px;
        border: none;
        cursor: pointer;
    }

        .btn:hover {
            opacity: 0.8;
        }

    body {
        font-family: Arial, sans-serif;
        margin: 20px;
    }

    h2, h3 {
        margin-bottom: 10px;
        color: #222;
    }

    input[readonly] {
        background-color: #f8f9fa;
        cursor: not-allowed;
    }
</style>
